---
title: "NSViewControllerでNSMenuItemから実行可能なdeleteを実装する"
emoji: "⛳"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Cocoa"]
published: true
---

自分のツイートをより詳細化した投稿です。
https://twitter.com/yosshi_4486/status/1634138855111811073?s=20

例えば「NSTableViewで⌫(デリートキー)を押した際に行を削除したい」というのは、割と良くあるケースだと思うので、これを試してみることにします。

Storyboardを利用を選択してMac Appのプロジェクトを作成すると、テンプレートでは以下のようにアプリケーションメニューが生成されており、deleteのNSMenuItemも最初から存在しています。

![Main.storyboardのScreenshot](./resources/ScreenShot%202023-03-11%2012.18.21.png)

しかし、iOSのUIResponderと違い、cut・copy・paste・deleteなどの標準アクションはNSResponderには実装されていないため、NSViewControllerでoverrideして実装というのが実現できません。どうしたらいいのか困ります。

こちらのStackoverflowの回答を見ると「Deleteはfirst responderに接続されているから、Deleteアクションに⌫を割り当てて、ViewControllerで@IBAction func delete(_ sender: Any?)を実装すれば実現できるよ」と書いてありますが本当でしょうか？試してみます。

![削除キーの割り当て](./resources/ScreenShot%202023-03-11%2012.41.21.png)

実装コードは下記のみです。

```swift
import Cocoa

class ViewController: NSViewController {

    override func viewDidLoad() {
        super.viewDidLoad()

        // Do any additional setup after loading the view.
    }

    override var representedObject: Any? {
        didSet {
        // Update the view, if already loaded.
        }
    }

    // 追加実装したメソッド
    @IBAction func delete(_ sender: Any?) {
        print("\(#function) is called")
    }

}
```

実行してみると、何もないViewControllerが表示されていますが、Deleteが実行できるようになっています。
![実行したアプリケーション](./resources/ScreenShot%202023-03-11%2012.43.19.png)

Deleteキーを押して実行すると、コンソールでprintが呼び出されたことを確認できます。
上記のdelete:メソッドで、NSTreeControllerやNSArrayControllerを使って行を削除する実装を行えば、冒頭の目的は果たせそうです。

![コンソールの表示](./resources/ScreenShot%202023-03-11%2012.52.45.png)

まだdeleteしか試していませんが、おそらく他の標準編集アクションについても、同様の処理が実現できるでしょう。

おわりです。